<script>
document.addEventListener('DOMContentLoaded', function() {
  const toggles = document.querySelectorAll('.details-toggle');

  toggles.forEach(function(toggle) {
    // Find the correct content to collapse.
    // It's the next sibling element after the toggle's parent container.
    const contentToCollapse = toggle.parentElement.nextElementSibling;

    // Hide the content initially by setting max-height to 0
    if (contentToCollapse.classList.contains('collapsible-content') || contentToCollapse.classList.contains('collapsible-details')) {
      // This line is a safeguard, usually handled by CSS, but good to have.
    }

    toggle.addEventListener('click', function() {
      this.classList.toggle('active');
      const isExpanded = this.classList.contains('active');

      if (isExpanded) {
        contentToCollapse.style.maxHeight = contentToCollapse.scrollHeight + 'px';
        this.setAttribute('aria-expanded', 'true');
        this.querySelector('.arrow').textContent = '▾';
        // Check if the button text should be changed
        if (this.firstChild.nodeType === Node.TEXT_NODE) {
          this.firstChild.textContent = 'Hide Details ';
        }
      } else {
        contentToCollapse.style.maxHeight = null;
        this.setAttribute('aria-expanded', 'false');
        this.querySelector('.arrow').textContent = '▸';
        // Check if the button text should be changed
        if (this.firstChild.nodeType === Node.TEXT_NODE) {
          this.firstChild.textContent = 'Show Details ';
        }
      }
    });
  });
});
</script>